{% extends "base.html" %}
{% block title %}Free Market Create Product{% endblock title %}
{% block content %}
  <h2>Create Product</h2>
  <form method="post">
    {% csrf_token %}
    <div class="form-group">
      <label for="store-select">Select Store:</label>
      <select id="store-select" name="store" class="form-control" required>
        {% for store in user_stores %}
          <option value="{{ store.id }}">{{ store.name }}</option>
        {% endfor %}
      </select>
    </div>
    <table>
      <div class="form-group">
        {{ product_form.as_table }}
      </div>
    </table>
    <h3 class='mt-3'>Add Tags</h3>
    <table>
      <tr>
        <td>
          <input type="text" id="tag-input" class="form-control" placeholder="Enter tag name">
        </td>
        <td>
          <button type="button" id="add-tag" class="btn btn-secondary">Add Tag</button>
        </td>
      </tr>
    </table>
    <ul id="tag-list"></ul>
    <input type="hidden" name="tags" id="tag-values">
    <button type="submit" name="create_product" class="btn btn-primary">Create Product</button>
  </form>
  <script>
    document.getElementById('add-tag').addEventListener('click', function() {
        const tagInput = document.getElementById('tag-input');
        const tagList = document.getElementById('tag-list');
        const tagValues = document.getElementById('tag-values');

        if (tagInput.value.trim() !== '') {
            const listItem = document.createElement('li');
            listItem.textContent = tagInput.value;
            tagList.appendChild(listItem);

            const currentTags = tagValues.value ? tagValues.value.split(',') : [];
            currentTags.push(tagInput.value.trim());
            tagValues.value = currentTags.join(',');

            tagInput.value = '';
        }
    });
  </script>
{% endblock %}
